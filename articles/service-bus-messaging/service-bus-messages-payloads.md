---
title: Azure Service Bus, nettoladingen en serialisatie | Microsoft Docs
description: Dit artikel bevat een overzicht van Azure Service Bus, nettoladingen, berichtroutering en serialisatie.
ms.topic: article
ms.date: 04/14/2021
ms.openlocfilehash: 2ed65054f61aee4b9fb6157fc7a36e469c7a672c
ms.sourcegitcommit: db925ea0af071d2c81b7f0ae89464214f8167505
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 04/15/2021
ms.locfileid: "107515291"
---
# <a name="messages-payloads-and-serialization"></a>Berichten, nettoladingen en serialisatie

Microsoft Azure Service Bus verwerkt berichten. Berichten bevatten een nettolading en metagegevens. De metagegevens hebben de vorm van eigenschappen van sleutel-waardeparen en beschrijven de nettolading en geven instructies voor het Service Bus toepassingen. Af en toe is die metagegevens voldoende om de informatie te bevatten die de afzender wil communiceren met ontvangers en blijft de nettolading leeg.

Het objectmodel van de officiële Service Bus-clients voor .NET en Java reflecteert de abstracte Service Bus-berichtstructuur, die is toe te wijst aan en van de wire-protocollen die Service Bus ondersteunt.
 
Een Service Bus bestaat uit een binaire nettoladingsectie die Service Bus nooit verwerkt in een vorm aan de servicezijde, en twee sets eigenschappen. De *brokereigenschappen* zijn vooraf gedefinieerd door het systeem. Deze vooraf gedefinieerde eigenschappen bepalen de functionaliteit op berichtniveau binnen de broker, of ze worden aan algemene en gestandaardiseerde metagegevensitems toegevoegd. De *gebruikerseigenschappen* zijn een verzameling sleutel-waardeparen die kunnen worden gedefinieerd en ingesteld door de toepassing.
 
De vooraf gedefinieerde brokereigenschappen worden vermeld in de volgende tabel. De namen worden gebruikt met alle officiële client-API's en ook in het JSON-object [BrokerProperties](https://docs.microsoft.com/rest/api/servicebus/introduction) van de HTTP-protocoltoewijzing.
 
De equivalente namen die worden gebruikt op het niveau van het AMQP-protocol worden tussen haakjes weergegeven. Hoewel voor de onderstaande namen gebruik wordt gemaakt van een casing van een casing, wordt voor JavaScript- en Python-clients respectievelijk gebruik gemaakt van camel- en casing-casing.

| Eigenschapsnaam                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `ContentType` (inhoudstype)           | Beschrijft eventueel de nettolading van het bericht, met een descriptor volgens de indeling RFC2045, sectie 5; bijvoorbeeld `application/json` .                                                                                                                                                                                                                                                                                             |
| `CorrelationId` (correlation-id)       | Hiermee kan een toepassing een context voor het bericht opgeven voor correlatiedoeleinden; geeft bijvoorbeeld de **MessageId weer** van een bericht dat wordt beantwoord.                                                                                                                                                                                                                                                                  |
| `DeadLetterSource`                      | Alleen ingesteld in berichten die in een impasse zijn geplaatst en later automatisch zijn doorvergezonden van de wachtrij voor inlopende berichten naar een andere entiteit. Geeft de entiteit aan waarin het bericht in een dead-letter is geschreven. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                  |
| `DeliveryCount`                         | <p>Aantal leveringen dat is geprobeerd voor dit bericht. Het aantal wordt verhoogd wanneer een berichtvergrendeling verloopt of het bericht expliciet wordt verlaten door de ontvanger. Deze eigenschap is alleen-lezen.</p> <p>Het aantal leveringen wordt niet verhoogd wanneer de onderliggende AMQP-verbinding wordt gesloten.</p>                                                                                                                                                                                                                                                 |
| `EnqueuedSequenceNumber`                | Voor berichten die automatisch zijn doorverzending, weerspiegelt deze eigenschap het volgnummer dat voor het eerst aan het bericht was toegewezen op het oorspronkelijke indieningspunt. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                                                |
| `EnqueuedTimeUtc`                       | Het UTC-moment waarop het bericht is geaccepteerd en opgeslagen in de entiteit. Deze waarde kan worden gebruikt als een gezaghebbende en neutrale aankomsttijdindicator wanneer de ontvanger de klok van de afzender niet wil vertrouwen. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                   |
| `ExpiresAtUtc` (absolute verlooptijd) | Het UTC-moment waarop het bericht is gemarkeerd voor verwijdering en niet meer beschikbaar is voor ophalen uit de entiteit vanwege de vervaldatum. De vervaldatum wordt bepaald door de **eigenschap TimeToLive** en deze eigenschap wordt berekend vanuit EnqueuedTimeUtc+TimeToLive. Deze eigenschap is alleen-lezen.                                                                                                                                                                           |
| `Label` of `Subject` (onderwerp)                       | Met deze eigenschap kan de toepassing op een gestandaardiseerde manier het doel van het bericht aan de ontvanger aangeven, vergelijkbaar met een onderwerpregel voor e-mail.                                                                                                                                                                                                                                                                                  |
| `LockedUntilUtc`                        | Voor berichten die worden opgehaald onder een vergrendeling (de ontvangstmodus peek-lock, niet vooraf vereffend) geeft deze eigenschap het UTC-instant aan totdat het bericht in de wachtrij/het abonnement is vergrendeld. Wanneer de vergrendeling is verlopen, wordt [de DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) verhoogd en kan het bericht opnieuw worden opgehaald. Deze eigenschap is alleen-lezen.                                                                                                                         |
| `LockToken`                             | Het vergrendelings-token is een verwijzing naar de vergrendeling die door de broker wordt vastgehouden in de ontvangstmodus *peek-lock.* Het token kan worden gebruikt om de vergrendeling permanent vast te maken via [de Deferral](message-deferral.md) API en daarmee het bericht uit de normale stroom van de leveringsstaat te krijgen. Deze eigenschap is alleen-lezen.                                                                                                                                                               |
| `MessageId` (message-id)                | De bericht-id is een door de toepassing gedefinieerde waarde die het bericht en de nettolading uniek identificeert. De id is een vrije tekenreeks en kan een GUID of een id weerspiegelen die is afgeleid van de toepassingscontext. Als deze optie is ingeschakeld, [identificeert](duplicate-detection.md) en verwijdert de functie duplicaatdetectie tweede en verdere verzendingen van berichten met dezelfde **MessageId.**                                                                |
| `PartitionKey`                          | Als [u deze waarde instelt voor](service-bus-partitioning.md)gepartities, kunt u gerelateerde berichten toewijzen aan dezelfde interne partitie, zodat de volgorde van de indieningsvolgorde correct wordt vastgelegd. De partitie wordt gekozen door een hash-functie boven deze waarde en kan niet rechtstreeks worden gekozen. Voor sessiebewuste entiteiten overschrijven **de eigenschap SessionId** deze waarde.                                                                                                       |
| `ReplyTo` (beantwoorden)                    | Deze optionele en toepassings gedefinieerde waarde is een standaard manier om een antwoordpad naar de ontvanger van het bericht uit te drukken. Wanneer een afzender een antwoord verwacht, stelt deze de waarde in op het absolute of relatieve pad van de wachtrij of het onderwerp waar het antwoord naar wordt verzonden.                                                                                                                                           |
| `ReplyToSessionId` (reply-to-group-id)  | Deze waarde breidt de **ReplyTo-informatie uit** en geeft aan welke **SessionId** moet worden ingesteld voor het antwoord wanneer deze wordt verzonden naar de antwoordentiteit.                                                                                                                                                                                                                                                                            |
| `ScheduledEnqueueTimeUtc`               | Voor berichten die pas na een vertraging beschikbaar worden gesteld voor ophalen, definieert deze eigenschap het UTC-moment waarop het bericht logisch wordt in de enqueu, gesequentieeerd en daarom beschikbaar wordt gesteld voor ophalen.                                                                                                                                                                                                                 |
| `SequenceNumber`                        | Het volgnummer is een uniek 64-bits geheel getal dat wordt toegewezen aan een bericht wanneer het wordt geaccepteerd en opgeslagen door de broker en als de werkelijke id fungeert. Voor gepartitiestiteiten weerspiegelen de bovenste 16 bits de partitie-id. Sequentienummers nemen monotone toe en zijn zonder hiaat. Ze worden naar 0 overgenomen wanneer het 48-64-bits bereik is uitgeput. Deze eigenschap is alleen-lezen.                                                                |
| `SessionId` (group-id)                  | Voor sessiebewuste entiteiten geeft deze toepassings gedefinieerde waarde de sessie-relatie van het bericht op. Berichten met dezelfde sessie-id zijn onderworpen aan samenvattingsvergrendeling en maken exacte verwerking op volgorde en demultiplexing mogelijk. Voor entiteiten die niet sessiebewust zijn, wordt deze waarde genegeerd.                                                                                                                                     |
                                                                                                                                          |
| `TimeToLive`                            | Deze waarde is de relatieve duur waarna het bericht verloopt, vanaf het moment dat het bericht is geaccepteerd en opgeslagen door de broker, zoals vastgelegd in **EnqueueTimeUtc.** Wanneer niet expliciet is ingesteld, is de veronderstelde waarde **de DefaultTimeToLive** voor de respectieve wachtrij of het betreffende onderwerp. Een **TimeToLive-waarde op** berichtniveau mag niet langer zijn dan de **instelling DefaultTimeToLive van de** entiteit. Als deze langer is, wordt deze op de stille hoogte aangepast. |
| `To` (naar)                               | Deze eigenschap is gereserveerd voor toekomstig gebruik in routeringsscenario's en wordt momenteel genegeerd door de broker zelf. Toepassingen kunnen deze waarde gebruiken in regelgestuurde scenario's voor automatisch ketenen om de beoogde logische bestemming van het bericht aan te geven.                                                                                                                                                                                   |
| `ViaPartitionKey`                       | Als een bericht wordt verzonden via een overdrachtswachtrij binnen het bereik van een transactie, selecteert deze waarde de overdrachtswachtrijpartitie.                                                                                                                                                                                                                                                                                                                 |

Met het abstracte berichtmodel kan een bericht in een wachtrij worden geplaatst via HTTPS en kan het worden opgehaald via AMQP. In beide gevallen ziet het bericht er normaal uit in de context van het respectieve protocol. De brokereigenschappen worden naar behoefte vertaald en de gebruikerseigenschappen worden naar de meest geschikte locatie in het respectieve protocolberichtmodel. In HTTP worden gebruikerseigenschappen rechtstreeks naar en van HTTP-headers toe te staan; in AMQP worden ze van en naar de **toepassingseigenschappenkaart** weergegeven.

## <a name="message-routing-and-correlation"></a>Berichtroutering en correlatie

Een subset van de brokereigenschappen die eerder zijn beschreven, met name , , , , en , worden gebruikt om toepassingen te helpen berichten naar `To` `ReplyTo` bepaalde bestemmingen te `ReplyToSessionId` `MessageId` `CorrelationId` `SessionId` sturen. Ter illustratie van deze functie kunt u enkele patronen overwegen:

- **Eenvoudige aanvraag/antwoord:** een uitgever verzendt een bericht naar een wachtrij en verwacht een antwoord van de bericht consumer. Om het antwoord te ontvangen, is de uitgever eigenaar van een wachtrij waarin wordt verwacht dat antwoorden worden afgeleverd. Het adres van die wachtrij wordt uitgedrukt in de **eigenschap ReplyTo** van het uitgaande bericht. Wanneer de consument reageert, kopieert deze de **MessageId** van het verwerkte bericht naar de eigenschap **CorrelationId** van het antwoordbericht en levert het bericht aan de bestemming die wordt aangegeven door de **eigenschap ReplyTo.** Eén bericht kan meerdere antwoorden opleveren, afhankelijk van de toepassingscontext.
- **Multicast-aanvraag/-antwoord:** Als een variant van het vorige patroon verzendt een uitgever het bericht naar een onderwerp en komen meerdere abonnees in aanmerking om het bericht te gebruiken. Elk van de abonnees kan reageren op de manier die eerder is beschreven. Dit patroon wordt gebruikt in detectie- of roll-callscenario's en de -scenario's identificeren zich doorgaans met een gebruikers-eigenschap of in de nettolading. Als **ReplyTo** naar een onderwerp wijst, kan een dergelijke set detectieantwoorden worden gedistribueerd naar een doelgroep.
- **Multiplexing:** deze sessiefunctie maakt multiplexing van stromen gerelateerde berichten mogelijk via één wachtrij of abonnement, zodat elke sessie (of groep) van gerelateerde berichten, geïdentificeerd door overeenkomende **SessionId-waarden,** wordt doorgeleid naar een specifieke ontvanger terwijl de ontvanger de sessie vergrendeld houdt. Lees hier meer over de details van [sessies.](message-sessions.md)
- **Multiplexed aanvraag/antwoord:** met deze sessiefunctie kunnen meerdere keren antwoorden worden gebruikt, zodat verschillende uitgevers een antwoordwachtrij kunnen delen. Door **ReplyToSessionId in** te stellen, kan de uitgever de consument(s) instrueren die waarde te kopiëren naar de **eigenschap SessionId** van het antwoordbericht. De publicatiewachtrij of het onderwerp hoeft niet sessiebewust te zijn. Als het bericht wordt verzonden, kan de uitgever vervolgens specifiek wachten tot een sessie met de opgegeven **SessionId** in de wachtrij wordt weergegeven door voorwaardelijk een sessieontvanger te accepteren. 

Routering binnen een Service Bus-naamruimte kan worden gerealiseerd met behulp van regels voor automatisch ketenen en onderwerpabonnementen. Routering tussen naamruimten kan worden gerealiseerd [met behulp van Azure LogicApps.](https://azure.microsoft.com/services/logic-apps/) Zoals aangegeven in de vorige lijst, is de eigenschap **Aan** gereserveerd voor toekomstig gebruik en kan deze uiteindelijk worden geïnterpreteerd door de broker met een speciaal ingeschakelde functie. Toepassingen die routering willen implementeren, moeten dit doen op basis van gebruikerseigenschappen en niet afhankelijk zijn van de **eigenschap Aan;** Als u dit nu doet, veroorzaakt dit echter geen compatibiliteitsproblemen.

## <a name="payload-serialization"></a>Payloadser serialisatie

Bij overdracht of opgeslagen in Service Bus, is de nettolading altijd een ondoorzichtig, binair blok. Met de eigenschap kunnen toepassingen de nettolading beschrijven, met de voorgestelde indeling voor de eigenschapswaarden een BESCHRIJVING van het `ContentType` MIME-inhoudstype volgens IETF RFC2045, bijvoorbeeld `application/json;charset=utf-8` .

In tegenstelling tot de Java- of .NET Standard-varianten ondersteunt de .NET Framework-versie van de Service Bus-API het maken van **BrokeredMessage-exemplaren** door willekeurige .NET-objecten door te geven aan de constructor. 

Wanneer u het verouderde SBMP-protocol gebruikt, worden deze objecten vervolgens geser serialiseerd met de standaard binaire serializer of met een serializer die extern wordt geleverd. Wanneer u het AMQP-protocol gebruikt, wordt het object geseraliseerd in een AMQP-object. De ontvanger kan deze objecten ophalen met de [methode GetBody \<T> (),](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) waarbij het verwachte type wordt opgehaald. Met AMQP worden de objecten geseraliseerd in een AMQP-grafiek van - en -objecten en kan elke `ArrayList` `IDictionary<string,object>` AMQP-client deze decoderen. 

Hoewel deze verborgen serialisatie-magic handig is, moeten toepassingen expliciete controle over objectseralisatie hebben en hun objectgrafieken in stromen veranderen voordat ze in een bericht worden op te nemen en het omgekeerde aan de ontvangstzijde doen. Dit levert interoperabele resultaten op. Hoewel AMQP een krachtig binair coderingsmodel heeft, is het gekoppeld aan het AMQP-berichtenecosysteem en kunnen HTTP-clients dergelijke nettoladingen niet decoderen. 

De .NET Standard- en Java API-varianten accepteren alleen byte-matrices, wat betekent dat de toepassing het besturingselement voor objectser serialisatie moet verwerken. 

## <a name="next-steps"></a>Volgende stappen

Zie de volgende onderwerpen Service Bus meer informatie over Service Bus messaging:

* [Service Bus-wachtrijen, -onderwerpen en -abonnementen](service-bus-queues-topics-subscriptions.md)
* [Aan de slag met Service Bus-wachtrijen](service-bus-dotnet-get-started-with-queues.md)
* [Service Bus-onderwerpen en -abonnementen gebruiken](service-bus-dotnet-how-to-use-topics-subscriptions.md)
