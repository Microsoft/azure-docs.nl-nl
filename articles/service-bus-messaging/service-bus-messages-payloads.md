---
title: Azure Service Bus berichten, nettoladingen en serialisatie | Microsoft Docs
description: Dit artikel bevat een overzicht van Azure Service Bus berichten, nettoladingen, bericht Routering en serialisatie.
ms.topic: article
ms.date: 01/29/2021
ms.openlocfilehash: e1baca1cd3dedee5917670a00b62c68752b5e4b8
ms.sourcegitcommit: 97c48e630ec22edc12a0f8e4e592d1676323d7b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 02/18/2021
ms.locfileid: "101095110"
---
# <a name="messages-payloads-and-serialization"></a>Berichten, nettoladingen en serialisatie

Microsoft Azure Service Bus verwerkt berichten. Berichten bevatten een Payload en meta gegevens. De meta gegevens bevindt zich in de vorm van sleutel/waarde-paar eigenschappen, en beschrijft de payload, en biedt verwerkings instructies voor Service Bus en toepassingen. In sommige gevallen is de meta gegevens alleen voldoende om de informatie te verstrekken die de afzender wil laten communiceren met ontvangers en de payload leeg blijft.

Het object model van de officiële Service Bus-clients voor .NET en Java weerspiegelt de abstracte Service Bus bericht structuur, die wordt toegewezen aan en van de bedradings protocollen Service Bus ondersteunt.
 
Een Service Bus bericht bestaat uit een binaire Payload sectie die Service Bus nooit in een van de formulieren aan de service zijde en twee sets eigenschappen. De *Eigenschappen* van de Broker zijn vooraf gedefinieerd door het systeem. Deze vooraf gedefinieerde eigenschappen beheersen de functionaliteit op bericht niveau binnen de Broker of ze worden toegewezen aan algemene en gestandaardiseerde meta gegevens items. De *gebruikers eigenschappen* zijn een verzameling sleutel-waardeparen die kunnen worden gedefinieerd en ingesteld door de toepassing.
 
De vooraf gedefinieerde Broker-eigenschappen worden weer gegeven in de volgende tabel. De namen worden gebruikt bij alle officiële client-Api's en ook in het JSON-object [BrokerProperties](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) van de http-protocol toewijzing.
 
De equivalente namen die worden gebruikt op het niveau van het AMQP-protocol, worden tussen haakjes weer gegeven. 

| Eigenschapsnaam                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  [`ContentType`](/dotnet/api/microsoft.azure.servicebus.message.contenttype) (type inhoud)           | Hiermee wordt optioneel de payload van het bericht beschreven, met een descriptor volgens de indeling RFC2045, sectie 5; bijvoorbeeld `application/json` .                                                                                                                                                                                                                                                                                             |
|  [`CorrelationId`](/dotnet/api/microsoft.azure.servicebus.message.correlationid#Microsoft_Azure_ServiceBus_Message_CorrelationId) (correlatie-id)       | Hiermee kan een toepassing een context voor het bericht opgeven voor het doel van correlatie; bijvoorbeeld weer spie gelen van de **MessageId** van een bericht waarop wordt geantwoord.                                                                                                                                                                                                                                                                  |
| [`DeadLetterSource`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deadlettersource)                      | Alleen instellen in berichten die niet zijn gefactureerd en later door de wachtrij met onbestelbare meldingen naar een andere entiteit worden doorgestuurd. Hiermee wordt de entiteit aangegeven waarin het bericht onbestelbaar is. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                  |
| [`DeliveryCount`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount)                         | <p>Aantal bezorgingen dat is geprobeerd dit bericht te verzenden. Het aantal wordt verhoogd wanneer een bericht vergrendeling verloopt of het bericht wordt door de ontvanger expliciet afgebroken. Deze eigenschap is alleen-lezen.</p> <p>Het aantal bezorgingen wordt niet verhoogd wanneer de onderliggende AMQP-verbinding wordt gesloten.</p>                                                                                                                                                                                                                                                 |
| [`EnqueuedSequenceNumber`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedsequencenumber)                | Voor berichten die zijn getransporteerd, wordt met deze eigenschap het Volg nummer aangegeven dat het eerst is toegewezen aan het bericht op het oorspronkelijke moment van verzen ding. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                                                |
| [`EnqueuedTimeUtc`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.enqueuedtimeutc)                       | De UTC-directe tijd waarop het bericht is geaccepteerd en opgeslagen in de entiteit. Deze waarde kan worden gebruikt als een gezaghebbende en neutrale aankomst tijd wanneer de ontvanger de klok van de afzender niet wil vertrouwen. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                   |
|  [`ExpiresAtUtc`](/dotnet/api/microsoft.azure.servicebus.message.expiresatutc) (absoluut verloop tijd) | De UTC-onmiddellijke waarop het bericht is gemarkeerd voor verwijdering en niet langer beschikbaar is voor het ophalen van de entiteit vanwege de verval datum. Expires wordt bepaald door de eigenschap **TimeToLive** en deze eigenschap wordt berekend op basis van EnqueuedTimeUtc + TimeToLive. Deze eigenschap is alleen-lezen.                                                                                                                                                                           |
| [`ForcePersistence`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence)                      | Voor wacht rijen of onderwerpen waarin de [`EnableExpress`](/dotnet/api/microsoft.servicebus.messaging.queuedescription.enableexpress) vlag is ingesteld, kan deze eigenschap worden ingesteld om aan te geven dat het bericht op de schijf moet worden bewaard voordat het wordt bevestigd. Dit gedrag is het standaard gedrag voor alle niet-Express-entiteiten.                                                                                                                                                                                                         |
| [`Label`](/dotnet/api/microsoft.azure.servicebus.message.label) betrokken                       | Met deze eigenschap kan de toepassing het doel van het bericht aan de ontvanger op een gestandaardiseerde manier aangeven, vergelijkbaar met een onderwerpregel van een e-mail.                                                                                                                                                                                                                                                                                  |
| [`LockedUntilUtc`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.lockeduntilutc)                        | Voor berichten die zijn opgehaald onder een vergren deling (kortings modus voor bekijken en vergren delen, niet vooraf vereffend), wordt met deze eigenschap de UTC-tekst weer gegeven totdat het bericht in de wachtrij/het abonnement is vergrendeld. Wanneer de vergren deling is verlopen, wordt de [DeliveryCount](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.deliverycount) verhoogd en is het bericht weer beschikbaar voor ophalen. Deze eigenschap is alleen-lezen.                                                                                                                         |
| [`LockToken`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.locktoken)                             | Het lock-token is een verwijzing naar de vergren deling die door de broker in de ontvangst modus *Peek-Lock* wordt gehouden. Het token kan worden gebruikt om de vergren deling permanent via de [uitstel](message-deferral.md) -API vast te maken en het bericht te halen uit de normale bezorgings status stroom. Deze eigenschap is alleen-lezen.                                                                                                                                                               |
| [`MessageId`](/dotnet/api/microsoft.azure.servicebus.message.messageid) (bericht-id)                | De bericht-id is een door een toepassing gedefinieerde waarde waarmee het bericht en de payload uniek worden geïdentificeerd. De id is een vrije teken reeks en kan een GUID of een id weer geven die is afgeleid van de toepassings context. Als deze optie is ingeschakeld, worden in de functie [Duplicaten detectie](duplicate-detection.md) de tweede en verdere verzen ding van berichten met dezelfde **MessageId** geïdentificeerd en verwijderd.                                                                |
| [`PartitionKey`](/dotnet/api/microsoft.azure.servicebus.message.partitionkey)                          | Voor [gepartitioneerde entiteiten](service-bus-partitioning.md)is het instellen van deze waarde het toewijzen van gerelateerde berichten aan dezelfde interne partitie mogelijk, zodat de volg orde van de inzendings volgorde correct wordt vastgelegd. De partitie wordt tijdens deze waarde gekozen door een hash-functie en kan niet rechtstreeks worden gekozen. Voor sessie bewuste entiteiten, wordt deze waarde door de eigenschap **SessionId** overschreven.                                                                                                       |
| [`ReplyTo`](/dotnet/api/microsoft.azure.servicebus.message.replyto) (beantwoorden)                    | Deze optionele en door de toepassing gedefinieerde waarde is een standaard manier om een antwoord pad naar de ontvanger van het bericht te sturen. Wanneer een afzender een antwoord verwacht, wordt de waarde ingesteld op het absolute of relatieve pad van de wachtrij of het onderwerp waaraan het antwoord wordt verzonden.                                                                                                                                           |
| [`ReplyToSessionId`](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid) (antwoord-naar-groep-ID)  | Deze waarde breidt de **ReplyTo** -informatie uit en geeft aan welke **SessionId** moet worden ingesteld voor het antwoord wanneer deze naar de antwoord entiteit wordt verzonden.                                                                                                                                                                                                                                                                            |
| [`ScheduledEnqueueTimeUtc`](/dotnet/api/microsoft.azure.servicebus.message.scheduledenqueuetimeutc)               | Voor berichten die alleen na een vertraging beschikbaar worden gesteld voor ophalen, wordt met deze eigenschap de UTC-tekst gedefinieerd waarmee het bericht logisch in de wachtrij wordt geplaatst, geordend en daarom beschikbaar gesteld voor ophalen.                                                                                                                                                                                                                 |
| [`SequenceNumber`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.sequencenumber)                        | Het Volg nummer is een uniek 64-bits geheel getal dat is toegewezen aan een bericht dat wordt geaccepteerd en opgeslagen door de Broker en functioneert als de werkelijke id. Voor gepartitioneerde entiteiten weerspiegelt de bovenste 16 bits de partitie-id. Volg nummers gestaag nemen toe en gapless. Ze worden overgerold naar 0 wanneer het 48-64-bits bereik is uitgeput. Deze eigenschap is alleen-lezen.                                                                |
| [`SessionId`](/dotnet/api/microsoft.azure.servicebus.message.sessionid) (groeps-id)                  | Voor sessie bewuste entiteiten geeft deze door de toepassing gedefinieerde waarde de sessie relatie van het bericht op. Berichten met dezelfde sessie-id zijn onderhevig aan het vergren delen van een samen vatting en bieden de mogelijkheid om een exacte volg orde en demultiplexing in te scha kelen. Voor entiteiten die geen sessie bewust zijn, wordt deze waarde genegeerd.                                                                                                                                     |
| [`Size`](/dotnet/api/microsoft.azure.servicebus.message.size)                                  | Hiermee wordt de opgeslagen grootte van het bericht in het Broker-logboek weer gegeven als een telling van bytes, aangezien het voor de opslag limiet wordt geteld. Deze eigenschap is alleen-lezen.                                                                                                                                                                                                                                                                                                       |
| [`State`](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.state)                                 | Hiermee wordt de status van het bericht in het logboek aangeduid. Deze eigenschap is alleen relevant tijdens het bladeren door berichten (' Peek ') om te bepalen of een bericht ' actief ' is en kan worden opgehaald wanneer het boven aan de wachtrij komt, ongeacht of het wordt uitgesteld, of dat er wordt gewacht om te worden gepland. Deze eigenschap is alleen-lezen.                                                                                                                                           |
| [`TimeToLive`](/dotnet/api/microsoft.azure.servicebus.message.timetolive)                            | Deze waarde is de relatieve duur waarna het bericht verloopt, te beginnen met het moment dat het bericht is geaccepteerd en opgeslagen door de Broker, zoals vastgelegd in **EnqueueTimeUtc**. Als deze niet expliciet worden ingesteld, is de aangenomen waarde de **DefaultTimeToLive** voor de respectievelijke wachtrij of het onderwerp. Een **TimeToLive** -waarde op bericht niveau kan niet langer zijn dan de **DefaultTimeToLive** -instelling van de entiteit. Als dat langer het geval is, wordt het op de achtergrond aangepast. |
| [Naar](/dotnet/api/microsoft.azure.servicebus.message.to) (aan)                               | Deze eigenschap is gereserveerd voor toekomstig gebruik in routerings scenario's en wordt momenteel genegeerd door de Broker zelf. Toepassingen kunnen deze waarde in regel-aangedreven, zelfgestuurde keten scenario's gebruiken om de beoogde logische bestemming van het bericht aan te geven.                                                                                                                                                                                   |
| [`ViaPartitionKey`](/dotnet/api/microsoft.azure.servicebus.message.viapartitionkey)                       | Als een bericht wordt verzonden via een overdrachts wachtrij in het bereik van een trans actie, selecteert deze waarde de overdrachts wachtrij partitie.                                                                                                                                                                                                                                                                                                                 |

Het abstract Message model maakt het mogelijk dat een bericht via HTTPS naar een wachtrij wordt gepost en kan worden opgehaald via AMQP. In beide gevallen wordt het bericht normaal weer gegeven in de context van het betreffende protocol. De Broker-eigenschappen worden naar behoefte omgezet en de gebruikers eigenschappen worden toegewezen aan de meest geschikte locatie in het desbetreffende protocol bericht model. In HTTP worden gebruikers eigenschappen rechtstreeks toegewezen aan en van HTTP-headers. in AMQP ze worden toegewezen aan en vanuit de toewijzing van de **toepassings eigenschappen** .

## <a name="message-routing-and-correlation"></a>Bericht Routering en correlatie

Een subset van de eigenschappen van de broker die eerder zijn beschreven, specifiek [voor](/dotnet/api/microsoft.azure.servicebus.message.to), [ReplyTo](/dotnet/api/microsoft.azure.servicebus.message.replyto), [ReplyToSessionId](/dotnet/api/microsoft.azure.servicebus.message.replytosessionid), [MessageId](/dotnet/api/microsoft.azure.servicebus.message.messageid), [CorrelationId](/dotnet/api/microsoft.azure.servicebus.message.correlationid)en [SessionId](/dotnet/api/microsoft.azure.servicebus.message.sessionid), worden gebruikt om toepassingen te helpen bij het routeren van berichten naar bepaalde bestemmingen. Als u deze functie wilt illustreren, overweegt u enkele patronen:

- **Eenvoudige aanvraag/antwoord**: een uitgever verzendt een bericht naar een wachtrij en verwacht een antwoord van de bericht verbruiker. Voor het ontvangen van het antwoord is de uitgever eigenaar van een wachtrij waarin wordt verwacht dat antwoorden worden bezorgd. Het adres van die wachtrij wordt weer gegeven in de eigenschap **ReplyTo** van het uitgaande bericht. Wanneer de Consumer reageert, wordt de **MessageId** van het verwerkte bericht gekopieerd naar de eigenschap **CorrelationId** van het antwoord bericht en wordt het bericht geleverd aan de bestemming aangegeven door de eigenschap **ReplyTo** . Een bericht kan meerdere antwoorden opleveren, afhankelijk van de toepassings context.
- **Multicast aanvraag/antwoord**: als variatie van het voor gaande patroon stuurt een uitgever het bericht naar een onderwerp en komen meerdere abonnees in aanmerking voor gebruik van het bericht. Elk van de abonnees reageert mogelijk op de manier die eerder is beschreven. Dit patroon wordt gebruikt bij detectie-of Roll-Call-scenario's en de respondent identificeert meestal zichzelf met een gebruikers eigenschap of binnen de payload. Als **ReplyTo** wijst naar een onderwerp, kan een set detectie reacties worden gedistribueerd naar een doel groep.
- **Multiplexing**: deze sessie functie maakt multiplexing van stromen van gerelateerde berichten mogelijk via één wachtrij of abonnement, zodat elke sessie (of groep) van gerelateerde berichten, geïdentificeerd door overeenkomende **SessionId** -waarden, wordt doorgestuurd naar een specifieke ontvanger terwijl de ontvanger de sessie onder slot bevindt. Lees [hier](message-sessions.md)meer over de details van sessies.
- **Multiplexed aanvraag/antwoord**: met deze sessie functie worden multiplex antwoorden toegestaan, waardoor meerdere uitgevers een antwoord wachtrij kunnen delen. Door **ReplyToSessionId** in te stellen, kan de uitgever de gebruiker (s) de opdracht geven om die waarde te kopiëren naar de eigenschap **SessionId** van het antwoord bericht. De publicatie wachtrij of het onderwerp hoeft geen sessie bewust te zijn. Wanneer het bericht wordt verzonden, kan de uitgever vervolgens een sessie met de opgegeven **SessionId** naar realiseren op de wachtrij wachten door een sessie ontvanger voorwaardelijk te accepteren. 

Route ring binnen een Service Bus naam ruimte kan worden gerealiseerd met behulp van regels voor het door sturen van reeksen en onderwerp-abonnementen. Route ring tussen naam ruimten kan worden gerealiseerd [met behulp van Azure LogicApps](https://azure.microsoft.com/services/logic-apps/). Zoals in de vorige lijst is aangegeven, is de eigenschap **aan** gereserveerd voor toekomstig gebruik en kan deze uiteindelijk door de Broker worden geïnterpreteerd met een speciaal ingeschakelde functie. Toepassingen die route ring willen implementeren, moeten dit doen op basis van gebruikers eigenschappen en niet Lean op de eigenschap **aan** . Dit veroorzaakt nu echter geen compatibiliteits problemen.

## <a name="payload-serialization"></a>Serialisatie van Payload

Wanneer u onderweg bent of opslaat in een Service Bus, is de payload altijd een ondoorzichtig, binair blok. De eigenschap [Content type](/dotnet/api/microsoft.azure.servicebus.message.contenttype) biedt toepassingen de mogelijkheid om de payload te beschrijven, waarbij de voorgestelde indeling voor de eigenschaps waarden een MIME-inhouds type beschrijving is volgens IETF RFC2045; bijvoorbeeld `application/json;charset=utf-8` .

In tegens telling tot de standaard varianten van Java of .NET, ondersteunt de .NET Framework versie van de Service Bus-API het maken van **BrokeredMessage** -instanties door wille keurige .net-objecten door te geven aan de constructor. 

Wanneer u het verouderde SBMP-protocol gebruikt, worden deze objecten vervolgens geserialiseerd met de standaard binaire serialisatiefunctie of met een serialisatiefunctie die extern is opgegeven. Wanneer u het AMQP-protocol gebruikt, wordt het object geserialiseerd in een AMQP-object. De ontvanger kan die objecten ophalen met de methode [GetBody \<T> ()](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.getbody#Microsoft_ServiceBus_Messaging_BrokeredMessage_GetBody__1) , waarbij het verwachte type wordt opgegeven. Met AMQP worden de objecten geserialiseerd in een AMQP-grafiek van `ArrayList` en `IDictionary<string,object>` -objecten en kunnen ze door elke AMQP-client worden gedecodeerd. 

Hoewel deze verborgen serialisatie Magic kan worden toegepast, moeten toepassingen expliciet controle krijgen over object-serialisatie en hun object grafieken omzetten in streams voordat ze in een bericht worden opgenomen, en worden de ontvangers op de achterkant omgekeerd. Dit levert interoperabele resultaten op. Hoewel AMQP een krachtig binair coderings model heeft, is het gekoppeld aan het AMQP-bericht ecosysteem en hebben HTTP-clients problemen met het decoderen van dergelijke payloads. 

De varianten van de .NET Standard-en Java-API accepteren alleen byte matrices, wat betekent dat de toepassing besturings element voor serialisatie van objecten moet verwerken. 

## <a name="next-steps"></a>Volgende stappen

Zie de volgende onderwerpen voor meer informatie over Service Bus Messa ging:

* [Service Bus-wachtrijen, -onderwerpen en -abonnementen](service-bus-queues-topics-subscriptions.md)
* [Aan de slag met Service Bus-wachtrijen](service-bus-dotnet-get-started-with-queues.md)
* [Service Bus-onderwerpen en -abonnementen gebruiken](service-bus-dotnet-how-to-use-topics-subscriptions.md)
